<BR>
<table>
    <tr>
        <td>
            <div id="expts_header" class="edit_header1">Experiments
                <div class="alts" style="float:right;position:relative;bottom:4px;">
                    <div id="view_all_link" style="display:none;">
                        <a id="toggle_expts_link" style="display:none;padding:0 4px;font-size:12px;font-weight:normal;text-decoration:underline;" onclick="XNAT.app.subject.toggleExptView();">
                            View All Experiments
                        </a>
                    </div>
                    <div id="expt_shared_legend" class="withThinBorder" style="display:none;background-color:#FFCC99;">
                        :Shared
                    </div>
                    <div id="expt_denied_legend" class="withThinBorder" style="display:none;background-color:#FF9999">
                        :Access Denied
                    </div>
                </div><!-- /alts -->
            </div><!-- /expts_header -->
        </td>
    </TR>
</table>
<BR><BR>

#set($hasOtherProjects=false)
#if($pScope)
<div id="proj_expts" style="display:none">
    <table align="left" width="100%">
        <tr>
            <td valign="top">
                <table>
                    <TR>
                        <TH align="left" class="underscore">Date</TH>
                        <TH align="left" class="underscore">Experiment</TH>
                        <TH align="left" class="underscore">Project</TH>
                        <TH align="left" class="underscore">Label</TH>
                    </TR>
                    #foreach ($assessor in $subject.getMinimalLoadAssessors())
                        #if($assessor.hasProject($project))
                            #parse($turbineUtils.getTemplateName("_assessor","xnat:subjectData",$project))
                        #else
                            #set($hasOtherProjects=true)
                        #end
                    #end
                </table>
            </td>
        </tr>
    </table>
</div>
#end
<div id="all_expts" style="display:none">
    <table align="left" width="100%">
        <tr>
            <td valign="top">
                <table>
                    <TR>
                        <TH align="left" class="underscore">Date</TH>
                        <TH align="left" class="underscore">Experiment</TH>
                        <TH align="left" class="underscore">Project</TH>
                        <TH align="left" class="underscore">Label</TH>
                    </TR>
                    #foreach ($assessor in $subject.getMinimalLoadAssessors())
                        #parse($turbineUtils.getTemplateName("_assessor","xnat:subjectData",$project))
                    #end
                </table>
            </td>
        </tr>
    </table>
</div>

<script type="text/javascript">
        #if($pScope && $hasOtherProjects)
        XNAT.app.subject.toggleExptView=function(){
            if(document.getElementById("all_expts").style.display=="block")
            {
                document.getElementById("toggle_expts_link").innerHTML="View All Experiments";
                document.getElementById("expts_header").innerHTML="Experiments in ${project}&nbsp;&nbsp;";
                document.getElementById("proj_expts").style.display="block";
                document.getElementById("all_expts").style.display="none";
            }else{
                document.getElementById("toggle_expts_link").innerHTML="View $project Only";
                document.getElementById("expts_header").innerHTML="All Experiments";
                document.getElementById("proj_expts").style.display="none";
                document.getElementById("all_expts").style.display="block";
            }
        }

        document.getElementById("view_all_link").style.display="inline-block";
        document.getElementById("proj_expts").style.display="block";
        document.getElementById("expts_header").innerHTML="Experiments in ${project}&nbsp;&nbsp;";
        #else
        document.getElementById("all_expts").style.display="block";
        #end

        #if($denied)
        document.getElementById("expt_denied_legend").style.display="inline-block";
        #end
        #if($shared)
        document.getElementById("expt_shared_legend").style.display="inline-block";
        #end
</script>